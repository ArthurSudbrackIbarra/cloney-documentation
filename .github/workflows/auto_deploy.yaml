# Workflow Name: Automatic Deploy

# Description:
# This workflow automatically deploys the documentation to GitHub Pages
# when a pull request is closed on the 'main' branch.

on:
  # Trigger the workflow when a pull request is closed on the 'main' branch.
  pull_request:
    types:
      - closed
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-22.04

    # Give permissions to modify repository contents.
    permissions:
      contents: write

    steps:
      # Step 1: Check out the repository.
      - uses: actions/checkout@v3
        with:
          # Check out the specific commit associated with the closed pull request.
          ref: ${{ github.event.pull_request.merge_commit_sha }}

      # Step 2: Use the MkDocs Material Docker image to build the documentation.
      - name: Build the Documentation
        run: |
          docker run --rm -v ${PWD}:/docs squidfunk/mkdocs-material build

      # Step 3: Deploy the documentation to GitHub Pages.
      - name: Deploy
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          # 'site' is the folder generated by the MkDocs Material Docker image.
          # This folder contains the static HTML files for the documentation.
          folder: site
